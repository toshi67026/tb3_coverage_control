<launch>
  <env name="ROSCONSOLE_FORMAT" value="[${severity}] [${node}]: ${message}"/>
  <rosparam command="delete" param="/"/>

  <rosparam command="load" file="$(find tb3_coverage_control)/config/base.yaml"/>
  <rosparam command="load" file="$(find tb3_coverage_control)/config/tb3.yaml"/>

  <arg name="real" default="false"/>

  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find tb3_coverage_control)/rviz/tb3.rviz"/>

  <node name="pose_collector" pkg="tb3_coverage_control" type="pose_collector.py"/>

  <!--Real mode-->
  <group if="$(arg real)">
    <include file="$(find tb3_coverage_control)/launch/vrpn_client.launch">
      <arg name="server" default="192.168.0.10"/>
    </include>

    <include file="$(find tb3_coverage_control)/launch/tb3_real.launch">
      <arg name="id" value="0"/>
    </include>
    <include file="$(find tb3_coverage_control)/launch/tb3_real.launch">
      <arg name="id" value="1"/>
    </include>
    <include file="$(find tb3_coverage_control)/launch/tb3_real.launch">
      <arg name="id" value="2"/>
    </include>
  </group>

  <!--Sim mode-->
  <group unless="$(arg real)">
    <include file="$(find tb3_coverage_control)/launch/start_gazebo_world.launch"/>

    <include file="$(find tb3_coverage_control)/launch/tb3_sim.launch">
      <arg name="id" value="0"/>
      <arg name="x_init" value="1.0"/>
      <arg name="y_init" value="0.0"/>
      <arg name="yaw_init" value="0.0"/>
    </include>
    <include file="$(find tb3_coverage_control)/launch/tb3_sim.launch">
      <arg name="id" value="1"/>
      <arg name="x_init" value="0.0"/>
      <arg name="y_init" value="1.0"/>
      <arg name="yaw_init" value="0.0"/>
    </include>
    <include file="$(find tb3_coverage_control)/launch/tb3_sim.launch">
      <arg name="id" value="2"/>
      <arg name="x_init" value="-1.0"/>
      <arg name="y_init" value="0.0"/>
      <arg name="yaw_init" value="0.5"/>
    </include>
  </group>
</launch>